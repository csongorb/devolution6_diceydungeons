on: workflow_dispatch
name: ğŸš€ Deploy to FTP (NOT folders)
jobs:
  web-deploy:
    name: ğŸ‰ Deploy
    runs-on: ubuntu-latest
    steps:
      - name: ğŸšš Get latest code
        uses: actions/checkout@v4

      - name: ğŸ”Œ Test FTP port 21
        run: |
          echo "Testing connectivity to ftp.devolution.online:21 ..."
          timeout 8 bash -lc 'cat < /dev/null > /dev/tcp/ftp.devolution.online/21' \
            && echo "âœ… Port 21 is reachable from GitHub runner" \
            || (echo "âŒ Port 21 is NOT reachable (blocked/firewalled)"; exit 1)

      - name: ğŸ“‚ Sync files (FTPS)
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          server: ftp.devolution.online
          username: ${{ secrets.ftp_username }}
          password: ${{ secrets.ftp_password }}
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/leaflet/**
            **/fontawesome-free-6.5.1-web/**
            **/iframemanager/**
            **/images/**
            **/leaflet-sidebar-v2/**
            **/leaflet-src/**
            **/pdfs/**
